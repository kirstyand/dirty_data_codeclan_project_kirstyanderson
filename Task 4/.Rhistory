# Load libraries
library(tidyverse)
library(janitor)
library(here)
# Load data
candy_2015 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2015.xlsx"))
library(readxl)
# Load data
candy_2015 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2015.xlsx"))
candy_2016 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2016.xlsx"))
candy_2017 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2017.xlsx"))
summary(candy_2015)
dim(candy_2015)
dim(candy_2016)
dim(candy_2017)
# are the columns the same
colnames(candy_2015)
2015_cols <- colnames(candy_2015)
cols_2015 <- colnames(candy_2015)
class(cols_2015)
cols_2015 <- as.list(colnames(candy_2015))
class(cols_2015)
cols_2016 <- as.list(colnames(candy_2016))
cols_2017 <- as.list(colnames(candy_2017))
identical(cols_2015, cols_2016, cols_2017)
identical(cols_2015, cols_2016)
install.packages("waldo")
library(waldo)
compare(cols_2015, cols_2016)
View(cols_2015)
View(candy_2015)
# clean column names
clean_names(c(candy_2015, candy_2016, candy_2017))
View(candy_2015)
candy_2015 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2015.xlsx"))
candy_2016 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2016.xlsx"))
candy_2017 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2017.xlsx"))
# clean column names
clean_names(candy_2015)
candy_2015 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2015.xlsx"))
candy_2016_clean <- clean_names(candy_2016)
# clean column names
candy_2015_clean <- clean_names(candy_2015)
candy_2017_clean <- clean_names(candy_2017)
View(candy_2015_clean)
View(candy_2016_clean)
View(candy_2017_clean)
View(candy_2017_clean)
View(candy_2016_clean)
cols_2015 <- as.list(colnames(candy_2015_clean))
cols_2016 <- as.list(colnames(candy_2016_clean))
cols_2017 <- as.list(colnames(candy_2017_clean))
View(cols_2015)
# There are some 'admin' columns at the start of each data set (age,gender,country,state, "going -out");
# recode these so that they are labelled the same in all 3 data sets
candy_2015_clean %>%
mutate(age = how_old_are_you)
# There are some 'admin' columns at the start of each data set (age,gender,country,state, "going -out");
# recode these so that they are labelled the same in all 3 data sets
candy_2015_clean <- candy_2015_clean %>%
mutate(age = how_old_are_you)
View(candy_2015_clean)
# There are some 'admin' columns at the start of each data set (age,gender,country,state, "going -out");
# recode these so that they are labelled the same in all 3 data sets
candy_2015_clean <- candy_2015_clean %>%
rename("age" = "how_old_are_you", "going_out" = "are_you_actually_going_trick_or_treating_yourself")
# There are some 'admin' columns at the start of each data set (age,gender,country,state, "going -out");
# recode these so that they are labelled the same in all 3 data sets
candy_2015_clean <- candy_2015_clean %>%
rename("age" = "how_old_are_you", "going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
View(candy_2015_clean)
# There are some 'admin' columns at the start of each data set (age,gender,country,state, "going -out");
# recode these so that they are labelled the same in all 3 data sets
candy_2015_clean <- candy_2015_clean %>%
rename("age" = "how_old_are_you", "going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
candy_2015_clean <- candy_2015_clean %>%
rename("age" = "how_old_are_you", "going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
candy_2015_clean %>%
group_by(how_old_are_you, age)
candy_2015_clean %>%
select(how_old_are_you, age)
candy_2015_clean %>%
select(how_old_are_you, age) %>%
duplicated()
candy_2015_clean %>%
select(how_old_are_you, age)
age <- candy_2015_clean %>%
select(how_old_are_you, age)
View(age)
age_check <- candy_2015_clean %>%
select(how_old_are_you, age) %>%
mutate(identical = if_else(how_old_are_you == age, "identical", "different"))
View(age_check)
age_check <- candy_2015_clean %>%
select(how_old_are_you, age) %>%
mutate(identical = if_else(how_old_are_you == age, "identical", "different")) %>%
filter(identical == "different")
View(age_check)
age_check <- candy_2015_clean %>%
select(how_old_are_you, age) %>%
mutate(identical = if_else(how_old_are_you == age, "identical", "different"))
View(age_check)
candy_2015_clean <- candy_2015_clean %>%
select(-"how_old_are_you") %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
View(candy_2015_clean)
candy_2015_clean <- candy_2015_clean %>%
select(-"how_old_are_you") %>%
relocate("age", .after = "timestamp") %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
candy_2015_clean <- clean_names(candy_2015)
candy_2015_clean <- candy_2015_clean %>%
select(-"how_old_are_you") %>%
relocate("age", .after = "timestamp") %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
candy_2015_clean <- clean_names(candy_2015)
candy_2015_clean <- candy_2015_clean %>%
select(-"how_old_are_you") %>%
relocate(age, .after = timestamp) %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
candy_2015_clean <- candy_2015_clean %>%
select(-"how_old_are_you") %>%
relocate(age) %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself")
View(candy_2015)
age_check <- candy_2015_clean %>%
select(how_old_are_you, age) %>%
mutate(identical = if_else(how_old_are_you == age, "identical", "different")) %>%
filter(identical == "different")
candy_2015 <- read_xlsx(here("raw_data/candy_ranking_data/boing-boing-candy-2015.xlsx"))
View(candy_2015)
candy_2015_clean <- candy_2015_clean %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself", "how_old_are_you" = "age")
candy_2015_clean <- clean_names(candy_2015)
candy_2015_clean_rename <- candy_2015_clean %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself", "age" = "how_old_are_you")
View(candy_2015_clean_rename)
View(candy_2016_clean)
candy_2016_clean_rename <- candy_2016_clean %>%
rename("going_out" = "are_you_going_actually_going_trick_or_treating_yourself", "age" = "how_old_are_you", "gender" = "your_gender", "country" = "which_country_do_you_live_in", "state" = "which_state_province_county_do_you_live_in")
View(candy_2016_clean_rename)
candy_2017_clean_rename <- candy_2017_clean %>%
str_replace(colnames(candy_2017_clean), "q[1:9]+")
candy_2017_clean_rename <- candy_2017_clean %>%
str_replace_all(colnames(candy_2017_clean), "q[1:9]+")
candy_2017_clean_rename <- candy_2017_clean %>%
rename_if(starts_with("q"), )
candy_2017_clean %>%
select(starts_with(q_))
candy_2017_clean %>%
select(starts_with("q[0:9]"))
candy_2017_clean_rename <- candy_2015_clean %>%
rename_with(test, starts_with("q[0:9]"))
candy_2017_clean_rename <- candy_2015_clean %>%
rename_with(test = starts_with("q[0:9]"))
candy_2017_clean_rename <- candy_2015_clean %>%
rename(test = starts_with("q[0:9]"))
View(candy_2017_clean_rename)
View(candy_2017_clean)
candy_2017_clean_rename <- candy_2017_clean %>%
rename(test = starts_with("q[0:9]"))
View(candy_2017_clean_rename)
View(candy_2017_clean)
candy_2017_clean_rename <- candy_2017_clean %>%
str_extract("q1_going_out")
candy_2017_clean_rename <- candy_2017_clean %>%
str_extract("q1_going_out", "^q")
candy_2017_clean_rename <- candy_2017_clean %>%
gsub("q","")
candy_2017_clean_rename <- candy_2017_clean %>%
gsub("q","", colnames(candy_2017_clean))
View(candy_2017_clean)
candy_2017_clean_rename <- candy_2017_clean %>%
gsub("q","", colnames(candy_2017_clean))
colnames(candy_2017_clean) <- gsub("q","",colnames(candy_2017_clean))
View(candy_2017_clean)
candy_2017_clean <- clean_names(candy_2017)
View(candy_2017_clean)
colnames(candy_2017_clean_rename) <- gsub("q","",colnames(candy_2017_clean))
colnames(candy_2017_clean) <- gsub("q","",colnames(candy_2017_clean_rename))
View(candy_2017_clean)
View(candy_2017_clean)
head(candy_2017_clean)
colnames(candy_2017_clean) <- gsub("q","",colnames(candy_2017_clean))
head(candy_2017_clean)
candy_2017_clean <- clean_names(candy_2017)
colnames(candy_2017_clean) <- gsub("q","",colnames(candy_2017_clean))
View(candy_2017_clean)
candy_2017_clean <- clean_names(candy_2017)
colnames(candy_2017_clean) <- gsub("q[0:9]_","",colnames(candy_2017_clean))
colnames(candy_2017_clean) <- gsub("q[0:9]_","",colnames(candy_2017_clean))
colnames(candy_2017_clean) <- gsub("(q[0:9]_)","",colnames(candy_2017_clean))
View(candy_2017_clean)
colnames(candy_2017_clean) <- gsub("([^q0:9_])","",colnames(candy_2017_clean))
candy_2017_clean <- clean_names(candy_2017)
colnames(candy_2017_clean) <- gsub("([^q0:9_])","",colnames(candy_2017_clean))
candy_2017_clean <- clean_names(candy_2017)
View(candy_2017_clean)
colnames(candy_2017_clean) <- gsub("([^q0:9])","",colnames(candy_2017_clean))
candy_2017_clean <- clean_names(candy_2017)
colnames(candy_2017_clean) <- gsub(([^q0:9]),"",colnames(candy_2017_clean))
colnames(candy_2017_clean) <- gsub([^q0:9],"",colnames(candy_2017_clean))
colnames(candy_2017_clean) <- gsub("[^q0:9]","",colnames(candy_2017_clean))
candy_2017_clean <- clean_names(candy_2017)
colnames(candy_2017_clean_rename) <- gsub("[q0:9]","",colnames(candy_2017_clean))
candy_2017_clean_rename <- candy
candy_2017_clean_rename <- candy_2017_clean
colnames(candy_2017_clean_rename) <- gsub("[q0:9]","",colnames(candy_2017_clean))
View(candy_2017_clean_rename)
colnames(candy_2017_clean_rename) <- str_remove(colnames(candy_2017_clean), "[^q0:9]")
View(candy_2017_clean_rename)
candy_2017_clean_rename <- candy_2017_clean
colnames(candy_2017_clean_rename) <- str_remove(colnames(candy_2017_clean), "q[0:9]")
candy_2017_clean_rename <- candy_2017_clean
colnames(candy_2017_clean_rename) <- str_remove(colnames(candy_2017_clean), "^q[0:9]")
colnames(candy_2017_clean_rename) <- str_remove(colnames(candy_2017_clean), "q[0:9]")
candy_2017_clean_rename <- candy_2017_clean
colnames(candy_2017_clean_rename) <- str_remove_all(colnames(candy_2017_clean), "q[0-9]")
candy_2017_clean_rename <- candy_2017_clean
colnames(candy_2017_clean_rename) <- str_remove_all(colnames(candy_2017_clean), "q[0-9]_")
candy_2017_clean_rename <- candy_2017_clean_rename %>%
rename("state" = "state_province_county_etc")
View(candy_2015_clean_rename)
View(candy_2016_clean_rename)
compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename)
compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename, return = "mismatch")
compare <- compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename, return = "mismatch")
View(compare)
compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename, return = "mismatch")
compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename, return = "mismatch")
compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename, return = "mismatch")
compare_df_cols(candy_2015_clean_rename, candy_2016_clean_rename)
cols_2015 <- as.list(colnames(candy_2015_clean_rename))
cols_2016 <- as.list(colnames(candy_2016_clean_rename))
cols_2017 <- as.list(colnames(candy_2017_clean_rename))
setdiff(cols_2015,cols_2016)
setdiff(cols_2015,cols_2016)
View(cols_2015)
View(cols_2016)
arrange(as.list(colnames(candy_2015_clean_rename)))
cols_2015 <- (as.list(order(colnames(candy_2015_clean_rename))))
compare_df_cols_same(candy_2015_clean_rename, candy_2016_clean_rename)
# find a way to compare other columns
adist("bonkers", "bonkers_the_candy")
cols_2015 <- as.list(colnames(candy_2015_clean_rename))
cols_2015 <- colnames(candy_2015_clean_rename)
cols_2016 <- colnames(candy_2016_clean_rename)
cols_2017 <- colnames(candy_2017_clean_rename)
class(cols_2015)
cols_2015 <- str_sort(colnames(candy_2015_clean_rename))
cols_2016 <- str_sort(colnames(candy_2016_clean_rename))
cols_2017 <- str_sort(colnames(candy_2017_clean_rename))
cols_2015 %in% cols_2016
intersect(cols_2015, cols_2016)
setdiff(cols_2015, cols_2016)
missing_15_16 <- setdiff(cols_2015, cols_2016)
missing_16_15 <- setdiff(cols_2016, cols_2015)
missing_15_16
candy_2015_clean_rename_rm <- candy_2015_clean_rename
colnames(candy_2015_clean_rename_rm) <- str_remove_all(colnames(candy_2015_clean_rename_rm), "_")
View(candy_2015_clean_rename_rm)
candy_2016_clean_rename_rm <- candy_2016_clean_rename
colnames(candy_2016_clean_rename_rm) <- str_remove_all(colnames(candy_2016_clean_rename_rm), "_")
View(candy_2016_clean_rename_rm)
cols_2015_rm <- str_sort(colnames(candy_2015_clean_rename_rm))
cols_2016_rm <- str_sort(colnames(candy_2016_clean_rename_rm))
missing_15_16_rm <- setdiff(cols_2015_rm, cols_2016_rm)
missing_16_15_rm <- setdiff(cols_2016_rm, cols_2015_rm)
